@page "/Imdb"
@inherits ComponenteCore

<HeadPage ImageSource="logo/imdb.png" Text="IMDb is the world's most popular and authoritative source for movie, TV and celebrity content. Find ratings and reviews for the newest movie and TV shows." Link="https://www.imdb.com/"></HeadPage>

<CardMediaList @ref="cardPopular" Service="@servicePopular" CardHeader="Popular" IsIMDB="true" HasTV="true"></CardMediaList>
<CardMediaList @ref="cardTopRated" Service="@serviceTopRated" CardHeader="Top Rated" IsIMDB="true" HasTV="true"></CardMediaList>
<CardMediaList @ref="cardUpcoming" Service="@serviceUpcoming" CardHeader="Upcoming" ShowOnlyYear="false"></CardMediaList>

@code {
    public CardMediaList cardPopular { get; set; }
    public CardMediaList cardTopRated { get; set; }
    public CardMediaList cardUpcoming { get; set; }

    public IMediaListService servicePopular { get; set; } = new Services.IMDB.PopularService();
    public IMediaListService serviceTopRated { get; set; } = new Services.IMDB.TopRatedService();
    public IMediaListService serviceUpcoming { get; set; } = new Services.IMDB.UpcomingService();

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            IsLoading = true;

            await LoadData(Settings);

            IsLoading = false;
        }
    }

    protected async Task LoadData(Settings Settings)
    {
        _ = cardPopular.LoadData(Settings);
        _ = cardTopRated.LoadData(Settings);
        _ = cardUpcoming.LoadData(Settings);
    }
}